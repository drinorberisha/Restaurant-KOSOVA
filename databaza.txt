CREATE TABLE MenuItems (
    item_id     INTEGER PRIMARY KEY AUTOINCREMENT,
    item_name   TEXT    NOT NULL,
    price       REAL    NOT NULL,
    subcategory TEXT,
    category    TEXT
);

CREATE TABLE Inventory (
    inventory_id     INTEGER PRIMARY KEY AUTOINCREMENT,
    item_id          INTEGER NOT NULL,
    current_count    INTEGER NOT NULL,
    minimum_required INTEGER NOT NULL,
    FOREIGN KEY (
        item_id
    )
    REFERENCES MenuItems (item_id) 
);

CREATE TABLE Tables (
    table_id         INTEGER PRIMARY KEY AUTOINCREMENT,
    table_number     INTEGER NOT NULL,
    status           TEXT    NOT NULL,
    current_order_id INTEGER,
    FOREIGN KEY (
        current_order_id
    )
    REFERENCES Orders (order_id) 
);

CREATE TABLE users (
    user_id    INTEGER PRIMARY KEY AUTOINCREMENT,
    first_name TEXT    NOT NULL,
    last_name  TEXT    NOT NULL,
    username   TEXT    UNIQUE
                       NOT NULL,
    password   TEXT    NOT NULL,
    card_uid   TEXT    UNIQUE,
    role       TEXT    NOT NULL,
    status     TEXT    NOT NULL
                       DEFAULT 'passive'
);

CREATE TABLE Orders (
    order_id    INTEGER  PRIMARY KEY AUTOINCREMENT,
    table_id    INTEGER  NOT NULL,
    total_price REAL     NOT NULL
                         DEFAULT 0,
    date_time   DATETIME DEFAULT CURRENT_TIMESTAMP,
    paid        BOOLEAN  NOT NULL
                         DEFAULT 0,
    FOREIGN KEY (
        table_id
    )
    REFERENCES Tables (table_id) 
);

CREATE TABLE OrderItemMenuItems (
    order_id INTEGER NOT NULL,
    item_id  INTEGER NOT NULL,
    PRIMARY KEY (
        order_id,
        item_id
    ),
    FOREIGN KEY (
        order_id
    )
    REFERENCES Orders (order_id),
    FOREIGN KEY (
        item_id
    )
    REFERENCES MenuItems (item_id) 
);
